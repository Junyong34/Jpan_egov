<?xml version="1.0" encoding="utf-8"?>    
<html> 
<head>
        <title>Cost Input</title>
        <script><![CDATA[ 
        $(document).ready(function(e) {
        
          $(document).keydown(function(e){   
                   
                    if(e.target.nodeName != "INPUT" && e.target.nodeName != "TEXTAREA"){       
                    if(e.keyCode === 8){   
                    return false;
                     }
                    }
                  });
        
        });
        
        
        $(function(){          
        	$('#UPLOAD').click(function(e){
        		$("#S1_FILE").val("");
        		e.preventDefault();   //이벤트 중단 현재	         
        		$("#S1_FILE").click();             
        	});    
        }); 
        
        function FIleUPload_F_FILE()
        {
         
         if( $("#out_message").val() != "" )
         {
            ErrorCheck();
            return;
         }
        
         if(  $("#S2_DATA_TYPE").val() == "")
         {
        	Return_RTN_MSG("00004","Condition");
        	return;
         }
        
         if($("#S1_FILE").val() != "") 
            wizutil.FileAjaxSubmit(Contextpath+'/jsp/File/fileupload.jsp', fileform, 'S1_FILE', 'uploadsubmit', ['xls','xlsx']);
        }
        
        function S2_FILE_OnChange(myObj)
        {
        	sbmCtlWrite.submit(false, "FIleUPload_F_FILE");
        }
        
        function uploadsubmit()
        {
        	sbmUpload.submit(false,"ErrorCheck");
        }
        
        function btn_download_OnClick(myObj)
        {
        	sbmCtlRead.submit(false, "download");
        //	download();
        }
        
        function download()
        {
          if( $("#out_message").val() != "" )
          {
            ErrorCheck();
            return;
          }
          
          if(  $("#S2_DATA_TYPE").val() == "")
          {
        	Return_RTN_MSG("00004","Condition");;
        	return;
          }
        	
          FormSubmit("frm" , "/hpms/20160901101142CostInput_csvdownload.do" , "S2[A]:S2" ,"",false); 
        }
        
        function ErrorCheck()
        {
        	if(ErroMsgDisplay() != 0) 
        	{
        	    
        	   var ERROR_CODE ="";
        	   ERROR_CODE= $("#out_message").val();
        	   
        	   if(ErroMsgDisplay() == 9999){
        	    ERROR_CODE= 9999;
        	   }
        	
        	   var param = ""
        	   param += "?ERROR_CODE="+ERROR_CODE+"&ERROR_MSG="+ErroMsgDisplay();
        	
        	   var url = "/hpms/20160906131150ErrorDisplay_loadpage.do"+param;
        		 
        		   $("#Error_cd").attr("src",url);
        		   $("#Error_cd").attr("frameborder", 0);
        		   $("#divPopup_ErrorCode").dialog({
        				autoPoen:false,
        				height : 260,
        				//position:[50,300],
        				width:530,
        				modal: true, 
        				title: "Error Indication",
        				resizable: true,
        				closeOnEscape:true ,
        			 
        			close: function(){ 
        	     
        			//	window.location.reload();
        				// iframe 초기화.
        	   $("#" + this.id).find('iframe').contents().find('body').html('');
        	  	}
        	  	});
        		   $("#divPopup_ErrorCode").dialog("open"); 
        	 }
        	 else
        	 {
        	     //오류업시 성공적으로 업로드 완료 했을 때    	
        	   	  alert("Upload complete");
             }
        }
        	
        function dialogClose_MYPAGE(){ //팝업종료및 
        	$("#divPopup_ErrorCode").dialog("close");
        }
        
        function btn_Error_OnClick(myObj)
        {
           if(  $("#out_message").val() == "" ||  $("#out_message").val() == "0" )
           {
              Return_RTN_MSG("00032");
              return;
           }
           
           if( $("#out_message").val() == "1012" ||  $("#out_message").val() == "1013" || 
               $("#out_message").val() == "1010" ||  $("#out_message").val() == "1011" )
           {
           	 Return_RTN_MSG("00033");
              return;
           }
        	              
           FormSubmit("frm" , "/hpms/20160901101142CostInput_errorConfirm.do" , "S9[A]:S9" ,"", false); 
        }
        
        ]]></script>
        
</head>
<body >
    <div id="pbmodel" style="display:none">
                    <DataSet>
                        <S1 dateformat="" >
                            <row  FILE=""   />
                        </S1>
                        <S2 dateformat="" >
                            <row  DATA_TYPE=""   />
                        </S2>
                        <C dateformat="" >
                            <row  ITEM_NM=""  ITEM_CD=""   />
                        </C>
                        <S9 dateformat="" >
                            <row  LOG_SEQ=""   />
                        </S9>
                        <init>
                            <S1>
                                <row  FILE=""   />
                            </S1>
                            <S2>
                                <row  DATA_TYPE=""   />
                            </S2>
                            <C>
                                <row  ITEM_NM=""  ITEM_CD=""   />
                            </C>
                            <S9>
                                <row  LOG_SEQ=""   />
                            </S9>
                        </init>
                        <RETURN>
                            <code></code>
                            <message></message>
                        </RETURN>
                    </DataSet>
            <submission  id="sbm_sbmInit" validate="false" method="post" replace="instance" instance="template"
                     indataset="" outdataset="S2_DATA_TYPE:SEL2" ref="DataSet" targetref="/data/DataSet"
                     action="/20160901101142CostInput_Condition_Combo.do" encoding="UTF-8" confirm="" menuid="20160901101142" eventid="Condition_Combo" menuname="80. Cost Input" eventname="04. Condition combo" callback="" msghandler="" errorhandler=""  >
            </submission>
            <submission  id="sbm_sbmUpload" validate="false" method="post" replace="instance" instance="template"
                     indataset="S1[A]:S1,S2[A]:S2" outdataset="S9:SEL33" ref="DataSet" targetref="/data/DataSet"
                     action="/20160901101142CostInput_CostUpload.do" encoding="UTF-8" confirm="" menuid="20160901101142" eventid="CostUpload" menuname="80. 원가입력" eventname="01. 원가입력(Excel Upload)" callback="" msghandler="" errorhandler=""  >
            </submission>
            <submission  id="sbm_sbmCtlWrite" validate="false" method="post" replace="instance" instance="template"
                     indataset="" outdataset="" ref="DataSet" targetref="/data/DataSet"
                     action="/20161004133312Control_MonthlyUsingCheck.do" encoding="UTF-8" confirm="" menuid="20161004133312" eventid="MonthlyUsingCheck" menuname="50. Common Control" eventname="01. Monthly  Control" callback="" msghandler="" errorhandler=""  >
            </submission>
            <submission  id="sbm_sbmCtlRead" validate="false" method="post" replace="instance" instance="template"
                     indataset="" outdataset="" ref="DataSet" targetref="/data/DataSet"
                     action="/20161004133312Control_SearchUsingCheck.do" encoding="UTF-8" confirm="" menuid="20161004133312" eventid="SearchUsingCheck" menuname="50. Common Control" eventname="03. Search Service Control" callback="" msghandler="" errorhandler=""  >
            </submission>
    </div>
    <div id="pbview" >
        	<userobject  location="613,26"  size="100,100"  inputstyle="width:100px; height:100px; border-width:1px; background-color:Transparent; color:Black; border-color:Transparent; text-align:left;" id="user1" bindcolumn=""  binddataset=""  unikey="63611265410484511529" value="" navindex="0"  ><![CDATA[ 
<!-- Error Code screen -->
<div id="divPopup_ErrorCode" name="divPopup_ErrorCode" style="display:none;background-color:white;">
	<iframe id="Error_cd" name="Error_cd" style="width:500px;height:190px;" scrolling="auto">
	</iframe>
</div>
]]></userobject>

        	<output  location="29,27"  size="435,36"  font-family="굴림체" font-size="9.75" inputclass="titleLabel" visible="True" inputstyle=" border-width:0px; background-color:Transparent; color:Black; line-height:Center; border-color:Black;text-align:left;" id="label1" bindcolumn=""  binddataset=""  unikey="63608757672371709764" label="Cost Input">    	</output>

        	<combo  location="145,111"  size="158,21"  requiredfield="true" requiredmsg="" font-family="굴림체" font-size="9.75" visible="True" inputstyle="width:158px; height:21px; background-color:White; color:Black; border-width:1px; border-color:Black; text-align:left;" id="S2_DATA_TYPE" bindcolumn="DATA_TYPE"  binddataset="S2"  unikey="63610142400031250034" bind="S2_DATA_TYPE_bnd" incremental="True" tabindex="0" itemdataset="C" itemlabel="ITEM_NM" itemcode="ITEM_CD" appearance="minimal" >
    	</combo>

        	<output  location="73,111"  size="71,21"  font-family="굴림체" font-size="9.75" inputclass="infoLabel" visible="True" inputstyle=" border-width:0px; background-color:Transparent; color:Black; line-height:Center; border-color:Black;text-align:left;" id="label2" bindcolumn=""  binddataset=""  unikey="63608757719955431466" label="Condition">    	</output>

        	<textbox  location="529,146"  size="118,21"  requiredfield="true" requiredmsg="" font-family="굴림체" font-size="9.75" inputclass="TextBox-S" inputstyle=" border-width:1px; background-color:White; color:Black; border-color:Black; text-align:left;" id="S9_LOG_SEQ" bindcolumn="LOG_SEQ"  binddataset="S9"  unikey="63611368898140625097" placeholder="" nubercheckevent="onChange" isnumber="False" commayn="False" pointlen="" minvalue="" maxvalue="" type="hidden" visible="True" maxlength="50" incremental="True" tabindex="0" >    	</textbox>

        	<button  location="332,165"  size="111,29"  font-family="굴림체" font-size="9.75" inputclass="btn2" style="" inputstyle=" border-width:1px; background-color:Gray; color:Black; border-color:#000000; text-align:center;" id="btn_Error" label="" type="button" src="" unikey="63611364739671875088" visible="True" value="Error Confirm" tabindex="0"  onclick="btn_Error_OnClick(this);" ></button>

        	<button  location="203,165"  size="111,29"  font-family="굴림체" font-size="9.75" inputclass="btn2" style="" inputstyle=" border-width:1px; background-color:Gray; color:Black; border-color:#000000; text-align:center;" id="UPLOAD" label="" type="button" src="" unikey="63608757777418718183" visible="True" value="Upload" tabindex="0"  ></button>

        	<button  location="72,166"  size="111,29"  font-family="Microsoft Sans Serif" font-size="10" inputclass="btn2" style="" inputstyle=" border-width:1px; background-color:Gray; color:Black; border-color:#000000; text-align:center;" id="btn_download" label="" type="button" src="" unikey="63610142253375000073" visible="True" value="Download" tabindex="0"  onclick="btn_download_OnClick(this);" ></button>

        	<upload  location="76,226"  size="100,21"  requiredfield="true" requiredmsg="" style="width:0px;height:0px;" visible="True" inputstyle="width:100px; height:21px;color:Black;" id="S1_FILE" bindcolumn="FILE"  binddataset="S1"  unikey="63608757789762424192" bind="S1_FILE_bnd" fileuploadurl="/jsp/File/fileupload.jsp" incremental="True"  tabindex="0"  onchange="S2_FILE_OnChange(this);" ></upload>

    </div>
</body>
</html>